<div class=" class container p-5">
  <div class="row mb-3">
    <div class="col-md-4 offset-md-8 d-flex justify-content-end">
      <input 
        type="text" 
        class="form-control w-auto" 
        placeholder="Rechercher un produit..." 
        [(ngModel)]="searchTerm"
        (ngModelChange)="onSearchChange($event)"/>
    </div>
  </div>
  <table class="table">
  <thead>
    <tr>
      <th>Nom</th>
        <th>Prix</th>
        <th>Stock</th>
        <th>Tailles</th>
        <th>Catégorie</th>
        <th>Status</th>
        <th>Date création</th>
        <th>Action</th>
    </tr>
  </thead>
  <tbody>
   <tr *ngFor="let product of filteredProducts">
        <td>{{ product.nom }}</td>
        <td>{{ product.prix | currency:'MAD ' }}</td>
        <td>{{ product.stock }}</td>
        <td>
          <span *ngFor="let size of product.sizes; let last = last">
            {{ size }}<span *ngIf="!last">, </span>
          </span>
        </td>
        <td>{{ getCategorieName(product) }}</td>
        <td>
          <div class="form-check form-switch">
            <input 
              class="form-check-input" 
              type="checkbox" 
              id="'flexSwitchCheckChecked-' + i"
              [checked]="isProductActive(product)"
              (change)="toggleProductStatus(getProductId(product))"
              role="switch">
          </div>
        </td>
        <td>{{ getDateCreated(product) | date:'short' }}</td>
        <td>
          <button class="btn btn-sm btn-warning me-2" title="Modifier">
            <i class="bi bi-pencil"></i>
          </button>
          <button class="btn btn-sm btn-danger me-2" 
                  (click)="deleteProduct(getProductId(product))" 
                  title="Supprimer">
            <i class="bi bi-trash"></i>
          </button>
          <button class="btn btn-sm btn-secondary" 
                  (click)="deactivateProduct(getProductId(product))" 
                  title="Désactiver">
            <i class="bi bi-x-circle"></i>
          </button>
        </td>
      </tr>
      <tr *ngIf="filteredProducts.length === 0">
        <td colspan="6" class="text-center">Aucun produit trouvé</td>
      </tr>
  </tbody>
</table>
</div>