<div class="feedback-container">
  <div class="container py-4">
    
    <!-- Success Message -->
    <div *ngIf="isSubmitted" class="row justify-content-center">
      <div class="col-md-6">
        <div class="success-card text-center">
          <div class="success-icon mb-3">
            <i class="bi bi-check-circle-fill text-success"></i>
          </div>
          <h2 class="success-title">Merci pour votre retour !</h2>
          <p class="success-message">
            Votre feedback a été envoyé avec succès. Nous apprécions vos commentaires 
            et nous les utiliserons pour améliorer nos services.
          </p>
          <div class="success-actions mt-4">
            <button class="btn btn-primary me-3" (click)="goToProducts()">
              <i class="bi bi-shop me-2"></i>Continuer mes achats
            </button>
            <button class="btn btn-outline-secondary" (click)="resetForm()">
              <i class="bi bi-arrow-repeat me-2"></i>Nouveau feedback
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Feedback Form -->
    <div *ngIf="!isSubmitted" class="row justify-content-center">
      <div class="col-lg-8 col-md-10">
        
        <!-- Header -->
        <div class="feedback-header text-center mb-4">
          <h1 class="page-title">
            <i class="bi bi-chat-heart me-3"></i>
            Dites-nous en plus sur votre expérience
          </h1>
          <p class="page-subtitle">
            Votre avis nous aide à améliorer nos services et à offrir une meilleure expérience à tous nos clients.
          </p>
        </div>

        <!-- Rating Section -->
        <div class="feedback-card mb-4">
          <div class="card-header">
            <h3 class="section-title mb-0">
              <i class="bi bi-star me-2"></i>
              Évaluez votre expérience
            </h3>
          </div>
          <div class="card-body text-center">
            <p class="rating-instruction mb-3">Cliquez sur les étoiles pour noter votre expérience</p>
            <div class="star-rating">
              <i *ngFor="let star of [1,2,3,4,5]; let i = index"
                 class="bi star-icon"
                 [class]="getStarClass(i + 1)"
                 (click)="setRating(i + 1)"
                 (mouseenter)="setHoveredRating(i + 1)"
                 (mouseleave)="clearHoveredRating()">
              </i>
            </div>
            <div class="rating-text mt-2" *ngIf="feedback.rating > 0">
              <span class="badge rating-badge">
                {{ feedback.rating === 1 ? 'Très insatisfait' :
                   feedback.rating === 2 ? 'Insatisfait' :
                   feedback.rating === 3 ? 'Neutre' :
                   feedback.rating === 4 ? 'Satisfait' :
                   'Très satisfait' }}
              </span>
            </div>
          </div>
        </div>

        <!-- Comment Section -->
        <div class="feedback-card mb-4">
          <div class="card-header">
            <h3 class="section-title mb-0">
              <i class="bi bi-chat-dots me-2"></i>
              Votre commentaire
            </h3>
          </div>
          <div class="card-body">
            <textarea class="form-control comment-textarea"
              [(ngModel)]="feedback.comment"
              placeholder="Décrivez votre expérience, ce qui vous a plu ou ce qui pourrait être amélioré..."
              rows="6"
              maxlength="500"></textarea>
            <div class="character-count mt-2">
              <small class="text-muted">
                {{ feedback.comment.length }}/500 caractères
              </small>
            </div>
          </div>
        </div>

        <!-- Contact Info Section (Optional) -->
        <div class="feedback-card mb-4">
          <div class="card-header">
            <h3 class="section-title mb-0">
              <i class="bi bi-person me-2"></i>
              Informations de contact (optionnel)
            </h3>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="userName" class="form-label">Nom complet</label>
                <input type="text" 
                  id="userName"
                  class="form-control" 
                  [(ngModel)]="feedback.userName"
                  placeholder="Votre nom complet (optionnel)">
              </div>
              <div class="col-md-6 mb-3">
                <label for="userEmail" class="form-label">Email</label>
                <input type="email" 
                  id="userEmail"
                  class="form-control" 
                  [(ngModel)]="feedback.userEmail"
                  placeholder="votre.email@exemple.com (optionnel)">
              </div>
            </div>
            <small class="text-muted">
              <i class="bi bi-info-circle me-1"></i>
              Ces informations sont optionnelles et nous permettront de vous contacter si nécessaire.
            </small>
          </div>
        </div>

        <!-- Actions -->
        <div class="feedback-actions text-center">
          <button class="btn btn-outline-secondary me-3" 
            (click)="goBack()"
            [disabled]="isSubmitting">
            <i class="bi bi-arrow-left me-2"></i>
            Retour
          </button>
          <button class="btn btn-primary btn-lg" 
            (click)="submitFeedback()"
            [disabled]="!isFormValid() || isSubmitting"
            [class.btn-success]="isSubmitted && !isSubmitting">
            <span *ngIf="!isSubmitting && !isSubmitted">
              <i class="bi bi-send me-2"></i>
              Envoyer mon feedback
            </span>
            <span *ngIf="isSubmitting && !isSubmitted">
              <i class="bi bi-arrow-clockwise spin me-2"></i>
              Envoi en cours...
            </span>
            <span *ngIf="isSubmitted && !isSubmitting">
              <i class="bi bi-check-lg me-2"></i>
              Envoyé avec succès !
            </span>
          </button>
        </div>

      </div>
    </div>
  </div>
</div>
